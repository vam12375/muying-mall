# æ¯å©´å•†åŸç³»ç»Ÿ (Muying Mall)

> åŸºäº Spring Boot 3.2.0 + Java 21 çš„ç°ä»£åŒ–æ¯å©´ç”µå•†å¹³å°

[![Spring Boot](https://img.shields.io/badge/Spring%20Boot-3.2.0-brightgreen)](https://spring.io/projects/spring-boot)
[![Java](https://img.shields.io/badge/Java-21-orange)](https://openjdk.org/)
[![MySQL](https://img.shields.io/badge/MySQL-8.0-blue)](https://www.mysql.com/)
[![Redis](https://img.shields.io/badge/Redis-7.4-red)](https://redis.io/)
[![License](https://img.shields.io/badge/License-MIT-yellow)](LICENSE)

## é¡¹ç›®ç®€ä»‹

æ¯å©´å•†åŸç³»ç»Ÿæ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œå–„çš„ç”µå•†å¹³å°ï¼Œä¸“æ³¨äºæ¯å©´ç”¨å“çš„åœ¨çº¿é”€å”®ã€‚ç³»ç»Ÿé‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œæä¾›å®Œæ•´çš„ç”¨æˆ·è´­ç‰©ä½“éªŒå’Œå•†å®¶ç®¡ç†åŠŸèƒ½ã€‚

### æ ¸å¿ƒç‰¹æ€§

- **ç°ä»£æŠ€æœ¯æ ˆ**: Spring Boot 3.2.0 + Java 21 è™šæ‹Ÿçº¿ç¨‹
- **å®Œæ•´ç”µå•†åŠŸèƒ½**: ç”¨æˆ·ã€å•†å“ã€è®¢å•ã€æ”¯ä»˜ã€ç‰©æµã€è¥é”€å…¨æµç¨‹
- **é«˜æ€§èƒ½æ¶æ„**: Redisç¼“å­˜ + Elasticsearchæœç´¢ + RabbitMQå¼‚æ­¥å¤„ç†
- **çŠ¶æ€æœºé©±åŠ¨**: è®¢å•å’Œæ”¯ä»˜çŠ¶æ€è§„èŒƒåŒ–ç®¡ç†
- **åˆ†å¸ƒå¼äº‹åŠ¡**: TCCæ¨¡å¼ä¿è¯æ•°æ®ä¸€è‡´æ€§
- **å®¹å™¨åŒ–éƒ¨ç½²**: Docker Compose ä¸€é”®å¯åŠ¨

## ç³»ç»Ÿæ¶æ„

> ğŸ“‹ è¯¦ç»†æ¶æ„å›¾è¯·æŸ¥çœ‹ [docs/diagrams/system-architecture.drawio](docs/diagrams/system-architecture.drawio)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å®¢æˆ·ç«¯å±‚                                â”‚
â”‚    ç§»åŠ¨ç«¯App  â”‚  Webå‰ç«¯  â”‚  ç®¡ç†åå°  â”‚  å°ç¨‹åº             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Nginx è´Ÿè½½å‡è¡¡                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Spring Boot åº”ç”¨å±‚                        â”‚
â”‚  Controller â†’ Security â†’ Service â†’ Mapper                   â”‚
â”‚  çŠ¶æ€æœº â”‚ äº‹ä»¶æ€»çº¿ â”‚ TCCäº‹åŠ¡ â”‚ åˆ†å¸ƒå¼é” â”‚ ç¼“å­˜ç®¡ç†            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      æ•°æ®å­˜å‚¨å±‚                              â”‚
â”‚   MySQL 8.0  â”‚  Redis 7.4  â”‚  Elasticsearch  â”‚  RabbitMQ   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æŠ€æœ¯æ ˆ

| åˆ†ç±» | æŠ€æœ¯ | ç‰ˆæœ¬ |
|------|------|------|
| **æ ¸å¿ƒæ¡†æ¶** | Spring Boot | 3.2.0 |
| **è¿è¡Œç¯å¢ƒ** | Java (Virtual Threads) | 21 |
| **å®‰å…¨æ¡†æ¶** | Spring Security + JWT | 6.x |
| **ORMæ¡†æ¶** | MyBatis-Plus | 3.5.9 |
| **æ•°æ®åº“** | MySQL | 8.0+ |
| **ç¼“å­˜** | Redis | 7.4 |
| **æœç´¢å¼•æ“** | Elasticsearch | 9.2.1 |
| **æ¶ˆæ¯é˜Ÿåˆ—** | RabbitMQ | 4.1 |
| **æ”¯ä»˜é›†æˆ** | æ”¯ä»˜å®SDK / å¾®ä¿¡æ”¯ä»˜SDK | 4.38.0 / 0.0.3 |
| **APIæ–‡æ¡£** | Knife4j (Swagger) | 4.3.0 |
| **å®¹å™¨åŒ–** | Docker + Docker Compose | - |

## åŠŸèƒ½æ¨¡å—

### ç”¨æˆ·ç«¯åŠŸèƒ½

| æ¨¡å— | åŠŸèƒ½ |
|------|------|
| **ç”¨æˆ·ç®¡ç†** | æ³¨å†Œç™»å½•ã€ä¸ªäººä¿¡æ¯ã€æ”¶è´§åœ°å€ã€ä¼šå‘˜ç­‰çº§ |
| **å•†å“æµè§ˆ** | åˆ†ç±»å¯¼èˆªã€å•†å“æœç´¢ã€å•†å“è¯¦æƒ…ã€æ”¶è— |
| **è´­ç‰©æµç¨‹** | è´­ç‰©è½¦ã€ä¸‹å•ç»“ç®—ã€åœ¨çº¿æ”¯ä»˜ã€è®¢å•è·Ÿè¸ª |
| **è¥é”€æ´»åŠ¨** | ä¼˜æƒ åˆ¸é¢†å–ä½¿ç”¨ã€ç§¯åˆ†è·å–å…‘æ¢ã€ç­¾åˆ°å¥–åŠ± |
| **å”®åæœåŠ¡** | é€€æ¬¾ç”³è¯·ã€ç‰©æµæŸ¥è¯¢ã€å•†å“è¯„ä»· |
| **ç¤¾åŒºäº’åŠ¨** | å¸–å­å‘å¸ƒã€è¯é¢˜è®¨è®ºã€å…³æ³¨ç‚¹èµ |

### ç®¡ç†ç«¯åŠŸèƒ½

| æ¨¡å— | åŠŸèƒ½ |
|------|------|
| **å•†å“ç®¡ç†** | å•†å“CRUDã€åˆ†ç±»ç®¡ç†ã€å“ç‰Œç®¡ç†ã€åº“å­˜ç®¡ç† |
| **è®¢å•ç®¡ç†** | è®¢å•æŸ¥è¯¢ã€å‘è´§å¤„ç†ã€é€€æ¬¾å®¡æ ¸ |
| **ç”¨æˆ·ç®¡ç†** | ç”¨æˆ·åˆ—è¡¨ã€è´¦æˆ·ç®¡ç†ã€æƒé™æ§åˆ¶ |
| **è¥é”€ç®¡ç†** | ä¼˜æƒ åˆ¸é…ç½®ã€ç§¯åˆ†è§„åˆ™ã€æ´»åŠ¨ç®¡ç† |
| **æ•°æ®ç»Ÿè®¡** | é”€å”®æŠ¥è¡¨ã€ç”¨æˆ·åˆ†æã€å•†å“åˆ†æ |
| **ç³»ç»Ÿç®¡ç†** | æ“ä½œæ—¥å¿—ã€ç³»ç»Ÿç›‘æ§ã€é…ç½®ç®¡ç† |

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- JDK 21+
- Maven 3.8+
- MySQL 8.0+
- Redis 7.0+
- RabbitMQ 4.0+ (å¯é€‰)
- Docker & Docker Compose (æ¨è)

### Docker éƒ¨ç½² (æ¨è)

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/your-repo/muying-mall.git
cd muying-mall

# å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps
```

æœåŠ¡å¯åŠ¨åè®¿é—®:
- åç«¯API: http://localhost:8080/api
- APIæ–‡æ¡£: http://localhost:8080/api/doc.html
- RabbitMQç®¡ç†: http://localhost:15672 (guest/guest)

### æœ¬åœ°å¼€å‘

```bash
# 1. åˆ›å»ºæ•°æ®åº“
mysql -u root -p -e "CREATE DATABASE muying_mall CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;"

# 2. å¯¼å…¥åˆå§‹æ•°æ®
mysql -u root -p muying_mall < src/main/resources/db/migration/init.sql

# 3. ä¿®æ”¹é…ç½®
# ç¼–è¾‘ src/main/resources/application-private.yml é…ç½®æ•°æ®åº“è¿æ¥

# 4. å¯åŠ¨åº”ç”¨
mvn spring-boot:run

# æˆ–ä½¿ç”¨ IDE è¿è¡Œ MuyingMallApplication.java
```

### é…ç½®è¯´æ˜

æ ¸å¿ƒé…ç½®æ–‡ä»¶:
- `application.yml` - ä¸»é…ç½®
- `application-private.yml` - ç§å¯†é…ç½® (æ•°æ®åº“å¯†ç ç­‰)
- `application-performance.yml` - æ€§èƒ½ä¼˜åŒ–é…ç½®

```yaml
# application-private.yml ç¤ºä¾‹
spring:
  datasource:
    username: root
    password: your_password
  data:
    redis:
      password: your_redis_password
```

## é¡¹ç›®ç»“æ„

```
muying-mall/
â”œâ”€â”€ src/main/java/com/muyingmall/
â”‚   â”œâ”€â”€ config/          # é…ç½®ç±» (Redis, MyBatis, Securityç­‰)
â”‚   â”œâ”€â”€ controller/      # æ§åˆ¶å™¨ (admin/, user/, common/)
â”‚   â”œâ”€â”€ service/         # ä¸šåŠ¡æœåŠ¡å±‚ (145+ æœåŠ¡)
â”‚   â”œâ”€â”€ mapper/          # MyBatis Mapperæ¥å£
â”‚   â”œâ”€â”€ entity/          # æ•°æ®åº“å®ä½“ (68ä¸ª)
â”‚   â”œâ”€â”€ dto/             # æ•°æ®ä¼ è¾“å¯¹è±¡
â”‚   â”œâ”€â”€ enums/           # æšä¸¾ç±»
â”‚   â”œâ”€â”€ statemachine/    # çŠ¶æ€æœº (è®¢å•/æ”¯ä»˜)
â”‚   â”œâ”€â”€ consumer/        # MQæ¶ˆæ¯æ¶ˆè´¹è€…
â”‚   â”œâ”€â”€ event/           # äº‹ä»¶å®šä¹‰
â”‚   â”œâ”€â”€ tcc/             # TCCåˆ†å¸ƒå¼äº‹åŠ¡
â”‚   â”œâ”€â”€ security/        # å®‰å…¨è®¤è¯
â”‚   â””â”€â”€ util/            # å·¥å…·ç±»
â”œâ”€â”€ src/main/resources/
â”‚   â”œâ”€â”€ db/migration/    # æ•°æ®åº“è¿ç§»è„šæœ¬
â”‚   â”œâ”€â”€ lua/             # Redis Luaè„šæœ¬
â”‚   â””â”€â”€ application*.yml # é…ç½®æ–‡ä»¶
â”œâ”€â”€ docs/                # é¡¹ç›®æ–‡æ¡£
â”‚   â”œâ”€â”€ architecture/    # æ¶æ„æ–‡æ¡£
â”‚   â”œâ”€â”€ business/        # ä¸šåŠ¡æµç¨‹æ–‡æ¡£
â”‚   â”œâ”€â”€ database/        # æ•°æ®åº“è®¾è®¡æ–‡æ¡£
â”‚   â”œâ”€â”€ development/     # å¼€å‘æŒ‡å—
â”‚   â””â”€â”€ diagrams/        # æ¶æ„å›¾ (DrawIO)
â”œâ”€â”€ docker-compose.yml   # Dockerç¼–æ’é…ç½®
â””â”€â”€ pom.xml              # Mavené…ç½®
```

## æ ¸å¿ƒä¸šåŠ¡æµç¨‹

### è®¢å•çŠ¶æ€æµè½¬

> ğŸ“‹ è¯¦ç»†çŠ¶æ€æœºå›¾è¯·æŸ¥çœ‹ [docs/diagrams/order-state-machine.drawio](docs/diagrams/order-state-machine.drawio)

```
[åˆ›å»ºè®¢å•] â†’ å¾…ä»˜æ¬¾ â†’ [æ”¯ä»˜æˆåŠŸ] â†’ å¾…å‘è´§ â†’ [å‘è´§] â†’ å·²å‘è´§ â†’ [ç¡®è®¤æ”¶è´§] â†’ å·²å®Œæˆ
                â†“                    â†“              â†“                â†“
           [å–æ¶ˆ/è¶…æ—¶]          [å–æ¶ˆè®¢å•]     [ç”³è¯·é€€æ¬¾]      [ç”³è¯·å”®å]
                â†“                    â†“              â†“                â†“
             å·²å–æ¶ˆ               å·²å–æ¶ˆ          é€€æ¬¾ä¸­ â†’ å·²é€€æ¬¾
```

### æ”¯ä»˜æµç¨‹

> ğŸ“‹ è¯¦ç»†æ—¶åºå›¾è¯·æŸ¥çœ‹ [docs/diagrams/payment-sequence.drawio](docs/diagrams/payment-sequence.drawio)

1. ç”¨æˆ·é€‰æ‹©æ”¯ä»˜æ–¹å¼ï¼Œè°ƒç”¨æ”¯ä»˜æ¥å£
2. ç³»ç»Ÿåˆ›å»ºæ”¯ä»˜è®°å½•ï¼Œè°ƒç”¨ç¬¬ä¸‰æ–¹æ”¯ä»˜API
3. ç”¨æˆ·è·³è½¬æ”¯ä»˜é¡µé¢å®Œæˆæ”¯ä»˜
4. æ”¯ä»˜å¹³å°å¼‚æ­¥é€šçŸ¥ï¼Œç³»ç»Ÿæ›´æ–°è®¢å•çŠ¶æ€
5. å‘é€æ¶ˆæ¯é€šçŸ¥ç”¨æˆ·æ”¯ä»˜æˆåŠŸ

## æ–‡æ¡£ç›®å½•

| æ–‡æ¡£ | è¯´æ˜ |
|------|------|
| [ç³»ç»Ÿæ¦‚è§ˆ](docs/architecture/system-overview.md) | ç³»ç»Ÿæ•´ä½“ä»‹ç» |
| [ç³»ç»Ÿæ¶æ„](docs/architecture/system-architecture.md) | æ¶æ„è®¾è®¡è¯¦è§£ |
| [éƒ¨ç½²æ¶æ„](docs/architecture/deployment-architecture.md) | éƒ¨ç½²æ–¹æ¡ˆè¯´æ˜ |
| [æ•°æ®åº“è®¾è®¡](docs/database/schema-design.md) | æ•°æ®åº“è¡¨ç»“æ„ |
| [E-Rå›¾](docs/database/er-diagram.md) | å®ä½“å…³ç³»å›¾ |
| [è®¢å•æµç¨‹](docs/business/order-process.md) | è®¢å•ä¸šåŠ¡æµç¨‹ |
| [æ”¯ä»˜æµç¨‹](docs/business/payment-process.md) | æ”¯ä»˜ä¸šåŠ¡æµç¨‹ |
| [å¼€å‘æŒ‡å—](docs/development/setup-guide.md) | å¼€å‘ç¯å¢ƒæ­å»º |
| [ç¼–ç è§„èŒƒ](docs/development/coding-standards.md) | ä»£ç è§„èŒƒ |

### æ¶æ„å›¾ (DrawIO)

æ‰€æœ‰æ¶æ„å›¾æºæ–‡ä»¶ä½äº `docs/diagrams/` ç›®å½•:

| å›¾è¡¨ | æ–‡ä»¶ |
|------|------|
| ç³»ç»Ÿæ¶æ„å›¾ | [system-architecture.drawio](docs/diagrams/system-architecture.drawio) |
| E-Rå®ä½“å…³ç³»å›¾ | [er-diagram.drawio](docs/diagrams/er-diagram.drawio) |
| è®¢å•æ—¶åºå›¾ | [order-sequence.drawio](docs/diagrams/order-sequence.drawio) |
| æ”¯ä»˜æ—¶åºå›¾ | [payment-sequence.drawio](docs/diagrams/payment-sequence.drawio) |
| è®¢å•çŠ¶æ€æœº | [order-state-machine.drawio](docs/diagrams/order-state-machine.drawio) |
| éƒ¨ç½²æ¶æ„å›¾ | [deployment-architecture.drawio](docs/diagrams/deployment-architecture.drawio) |

## API æ–‡æ¡£

å¯åŠ¨åº”ç”¨åè®¿é—® Swagger UI:
- åœ°å€: http://localhost:8080/api/doc.html

ä¸»è¦APIåˆ†ç»„:
- ç”¨æˆ·API: `/api/user/**`
- å•†å“API: `/api/product/**`
- è®¢å•API: `/api/order/**`
- æ”¯ä»˜API: `/api/payment/**`
- ç®¡ç†API: `/api/admin/**`

## æ€§èƒ½ä¼˜åŒ–

### å·²å®æ–½çš„ä¼˜åŒ–

- **è™šæ‹Ÿçº¿ç¨‹**: Java 21 Virtual Threads æ”¯æŒé«˜å¹¶å‘
- **è¿æ¥æ± ä¼˜åŒ–**: Tomcat max-connections=20000, Redis max-active=100
- **ç¼“å­˜ç­–ç•¥**: å¤šçº§ç¼“å­˜ï¼Œçƒ­ç‚¹æ•°æ®Redisç¼“å­˜
- **å¼‚æ­¥å¤„ç†**: RabbitMQ æ¶ˆæ¯é˜Ÿåˆ—å¼‚æ­¥å¤„ç†
- **æœç´¢ä¼˜åŒ–**: Elasticsearch å…¨æ–‡æœç´¢ï¼Œé™çº§æ–¹æ¡ˆ
- **åº“å­˜æ‰£å‡**: Redis Luaè„šæœ¬åŸå­æ“ä½œ

### æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | ç›®æ ‡å€¼ |
|------|--------|
| APIå“åº”æ—¶é—´ | < 200ms |
| é¡µé¢åŠ è½½æ—¶é—´ | < 2s |
| æœç´¢å“åº”æ—¶é—´ | < 100ms |
| å¹¶å‘ç”¨æˆ·æ”¯æŒ | 1000+ |

## è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/amazing-feature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add amazing feature'`)
4. æ¨é€åˆ†æ”¯ (`git push origin feature/amazing-feature`)
5. æäº¤ Pull Request

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶

## è”ç³»æ–¹å¼

- ä½œè€…: é’æŸ æª¬
- é¡¹ç›®åœ°å€: https://github.com/your-repo/muying-mall

---

*æœ€åæ›´æ–°: 2025-12-31*
